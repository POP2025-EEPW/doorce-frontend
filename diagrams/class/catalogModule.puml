@startuml
title Catalog Feature - PVCUC component view

skinparam packageStyle rectangle

package "Catalog Views" {
  class CatalogsPageView {
    +render(catalogs)
    +onOpen(id)
  }
  class CatalogListView {
    +render(catalogs)
    +onOpen(id)
  }
  class AddCatalogFormView {
    +render()
    +submit(input)
  }
  class SubcatalogListView {
    +render(children)
    +onOpen(id)
  }
  class AddSubcatalogCardView {
    +render()
    +submit(input)
  }
}

package "Dataset Views" {
  class AddDatasetSectionView {
    +render(catalogId, ownerId)
  }
  class AddDatasetFormView {
    +render()
    +submit(input)
  }
  class DatasetTableView {
    +render(datasets)
    +onOpen(id)
  }
}

package "Presenters" {
  class CatalogsPresenter {
    +render()
    +handleAddCatalog(input)
    +openCatalog(id)
  }
  class CatalogDetailPresenter {
    +render()
    +handleAddSubcatalog(input)
    +handleAddDataset(input)
    +openDataset(id)
  }
}

package "Controllers" {
  class CatalogsController {
    +listCatalogs(parentId)
    +getCatalog(id)
    +addCatalog(input)
    +listCatalogDatasets(catalogId, page, pageSize)
  }
  class DatasetsController {
    +addDataset(input)
    +getDataset(id)
  }
}

package "Use-case Layer" {
  interface DatasetUseCases {
    +listCatalogs(parentId)
    +getCatalog(id)
    +addCatalog(input)
    +listCatalogDatasets(catalogId, page, pageSize)
    +addDataset(input)
    +getDataset(id)
  }
}

package "DI Container" {
  class UCContainer {
    +dataset: DatasetUseCases
  }
}

CatalogsPresenter --> CatalogsPageView : render()
CatalogsPresenter --> CatalogListView : render()
CatalogsPresenter --> AddCatalogFormView : render()
CatalogsPageView --> CatalogsPresenter : callbacks
CatalogListView --> CatalogsPresenter : onOpen(id)
AddCatalogFormView --> CatalogsPresenter : onSubmit(input)
CatalogsPresenter --> CatalogsController : load/add operations

CatalogDetailPresenter --> SubcatalogListView : render()
SubcatalogListView --> CatalogDetailPresenter : onOpen(id)
CatalogDetailPresenter --> AddSubcatalogCardView : render()
AddSubcatalogCardView --> CatalogDetailPresenter : onSubmit(input)
CatalogDetailPresenter --> DatasetTableView : render()
DatasetTableView --> CatalogDetailPresenter : onOpen(id)
CatalogDetailPresenter --> AddDatasetSectionView : render()
AddDatasetSectionView --> AddDatasetFormView : compose
AddDatasetFormView --> CatalogDetailPresenter : onSubmit(input)
CatalogDetailPresenter --> CatalogsController : fetch catalogs/datasets
CatalogDetailPresenter --> DatasetsController : addDataset(), getDataset()

CatalogsController --> DatasetUseCases : delegates to uc.dataset
DatasetsController --> DatasetUseCases : delegates to uc.dataset

CatalogsController --> UCContainer : reads dataset
DatasetsController --> UCContainer : reads dataset
UCContainer --> DatasetUseCases : provides implementation

@enduml
