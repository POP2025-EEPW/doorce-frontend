@startuml
title Dataset Feature - PVCUC component view

skinparam packageStyle rectangle

package "Views" {
  class DatasetInfoView {
    +render(dataset)
  }
  class AddDatasetFormView {
    +render()
    +submit(input)
  }
  class AddDatasetSectionView {
    +render(catalogId, ownerId)
  }
  class DatasetTableView {
    +render(datasets)
    +onOpen(id)
  }
  class DatasetCommentsView {
    +render(comments)
    +onShowComments(datasetId)
  }
  class DatasetListView {
    +render()
  }
  class CatalogsPageView {
    +render()
  }
}

package "Presenters" {
  class DatasetDetailPresenter {
    +render()
    +loadDataset(id)
  }
  class CatalogDetailPresenter {
    +render()
    +handleAddDataset(input)
    +loadCatalogDatasets(catalogId)
  }
}

package "Controllers" {
  class DatasetsController {
    +getDataset(id)
    +addDataset(input)
    +listCatalogDatasets(catalogId, page, pageSize)
    +listDatasets(filter, page, pageSize)
    +getDatasetDescription(datasetId)
    +listOwnedDatasets(ownerId)
    +listQualityControllableDatasets(controllerId)
    +loadDatasetComments(datasetId)
    +getDatasetComents(datasetId)
  }
  class CatalogsController {
    +getCatalog(id)
    +listCatalogs(parentId)
  }
}

package "Use-case Layer" {
  interface DatasetUseCases {
    +getDataset(id)
    +addDataset(input)
    +listCatalogDatasets(catalogId, page, pageSize)
    +getCatalog(id)
    +listCatalogs(parentId)
    +listDatasets(filter, page, pageSize)
    +getDatasetDescription(datasetId)
    +listOwnedDatasets(ownerId)
    +listQualityControllableDatasets(controllerId)
    +getDatasetComments(datasetId)
  }
}

package "DI Container" {
  class UCContainer {
    +dataset: DatasetUseCases
  }
}

package "API" {
  class DatasetAPI {
    +GET /datasets/{id}
    +POST /datasets
    +GET /catalogs/{id}/datasets
    +GET /catalogs/{id}
    +GET /catalogs
    +GET /datasets
    +GET /datasets/{id}/description
    +GET /users/{id}/datasets
    +GET /users/{id}/quality-controllable-datasets
    +GET /datasets/{id}/comments
  }
}

DatasetDetailPresenter --> DatasetInfoView : render()
DatasetInfoView --> DatasetDetailPresenter : props/events
DatasetDetailPresenter --> DatasetsController : loadDataset(id)

CatalogDetailPresenter --> DatasetTableView : render()
DatasetTableView --> CatalogDetailPresenter : onOpen(id)
CatalogDetailPresenter --> AddDatasetSectionView : render()
AddDatasetSectionView --> AddDatasetFormView : compose
AddDatasetFormView --> CatalogDetailPresenter : onSubmit(input)
CatalogDetailPresenter --> DatasetsController : add/list datasets
CatalogDetailPresenter --> CatalogsController : get catalog context
DatasetDetailPresenter --> DatasetCommentsView : render(comments)

DatasetsController --> DatasetUseCases : delegates
CatalogsController --> DatasetUseCases : delegates shared calls
DatasetsController --> DatasetUseCases : getDatasetComents(datasetId)
DatasetsController --> DatasetUseCases : getDatasetPreview(id)

DatasetsController --> UCContainer : reads dataset uc
CatalogsController --> UCContainer : reads dataset uc
UCContainer --> DatasetUseCases : provides implementation

DatasetListView --> DatasetsController : loadDatasetComments(datasetId)
CatalogsPageView --> DatasetsController :  loadDatasetPreview(datasetId)

DatasetUseCases --> DatasetDetailPresenter : present(DatasetComment[])
DatasetUseCases --> DatasetDetailPresenter : present(DatasetPreview)



@enduml
